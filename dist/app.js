!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=125)}({125:function(e,t,r){"use strict";var n,a,o,i,c,u,s=(n=v(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Word.run(function(){var e=v(regeneratorRuntime.mark(function e(r){var n,a,o,i,c,u,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.document.getSelection(),a=document.getElementById("inputVariableName").value,o=document.getElementById("checkboxVariableReplaceAll").checked,i=document.getElementById("selectVariableFormat").value,c=""==i?a:i+"("+a+")",n.load("text"),o){e.next=10;break}n.insertText("{{ "+a+" }}","Replace"),e.next=18;break;case 10:return e.next=12,r.sync();case 12:return u=n.text,s=r.document.body.search(u.trim(),{matchWholeWord:!0}),r.load(s),e.next=17,r.sync();case 17:for(l=0;l<s.items.length;l++)s.items[l].insertText("{{ "+c+" }}","Replace");case 18:return e.next=20,r.sync();case 20:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)}),l=(a=v(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Word.run(function(){var e=v(regeneratorRuntime.mark(function e(r){var n,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.document.getSelection(),a=document.getElementById("inputIfExpression").value,n.load("text"),o="{%p if "+a+" %}",n.insertParagraph(o,"Before"),n.insertParagraph("{%p endif %}","After"),e.next=8,r.sync();case 8:console.log("The selected text was "+n.text+".");case 9:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)}),p=(o=v(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Word.run(function(){var e=v(regeneratorRuntime.mark(function e(r){var n,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.document.getSelection(),a=document.getElementById("inputIfExpression").value,o="{% if "+a+" %}",n.load("text"),n.insertText(o,"Before"),n.insertText("{% endif %}","After"),e.next=8,r.sync();case 8:console.log("The selected text was "+n.text+".");case 9:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)}),d=(i=v(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Word.run(function(){var e=v(regeneratorRuntime.mark(function e(r){var n,a,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.document.getSelection(),a=document.getElementById("inputListVariableName").value,o=document.getElementById("checkboxOnlyTrue").checked,i=o?"{%p for item in "+a+".true_values() %}":"{%p for item in "+a+"%}",n.load("text"),n.insertText("{{ item }}","Replace"),n.insertParagraph(i,"Before"),n.insertParagraph("{%p endfor %}","After"),e.next=10,r.sync();case 10:console.log("The selected text was "+n.text+".");case 11:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)}),f=(c=v(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Word.run(function(){var e=v(regeneratorRuntime.mark(function e(r){var n,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=r.document.getSelection()).load("text"),e.next=4,r.sync();case 4:return a=new RegExp("({#)([\\s\\S]*)(#})"),(o=a.exec(n.text))?(n.insertText(o[2],"Replace"),console.log("Removed comments.")):(n.insertParagraph("{#","Before"),n.insertParagraph("#}","After"),console.log("Added comments.")),e.next=9,r.sync();case 9:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e,this)})),function(){return c.apply(this,arguments)}),m=(u=v(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Word.run(function(){var e=v(regeneratorRuntime.mark(function e(r){var n,a,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.document.getSelection(),a=document.getElementById("inputTemplateName").value,o=document.getElementById("inputTemplateOptions").value,i=""==o?'{{p include_docx_template("'+a+'") }}':'{{p include_docx_template("'+a+'", '+o+") }}",n.load("text"),n.insertText(i,"Replace"),e.next=8,r.sync();case 8:console.log("The selected text was "+n.text+".");case 9:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)});function v(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,o){try{var i=t[a](o),c=i.value}catch(e){return void r(e)}if(!i.done)return Promise.resolve(c).then(function(e){n("next",e)},function(e){n("throw",e)});e(c)}("next")})}}var h="";function g(e){if(e.origin===h){if(console.log("Received action "+e.data.action),"initialize"==e.data.action&&($("#server").hide(),$("#app-body").show(),x()),"files"==e.data.action){var t=$("#interviewName").val();$("#interviewName").empty();var r=$("<option>");r.text("Select an interview..."),$("#interviewName").append(r);for(var n=e.data.files.length,a=0;a<n;a++){var o=$("<option>");o.attr("value",e.data.files[a]),o.text(e.data.files[a]),e.data.files[a]==t&&o.prop("selected",!0),$("#interviewName").append(o)}}"vars"==e.data.action&&(e.data.vars,e.data.vocab,x())}else console.log("Message received from improper origin.")}function x(){$("#server")[0].contentWindow.postMessage({action:"fetchFiles"},h)}Office.initialize=function(e){$(document).ready(function(){$("#sideload-msg").hide();try{var e=document.getElementById("server").contentWindow.document;e.open(),e.write("<html><head><title></title></head><body>Loading...</body></html>"),e.close()}catch(e){console.log(e.message)}$("#app-body").hide(),$("#serverSet").on("click",function(){return e=$("#serverName").val(),/^https?:\/\/\S/i.test(e)?($("#serverNameError").hide(),$("#serverNameDiv").hide(),h=$("#serverName").val(),Cookies.set("serverName",h,{expires:999999}),$("#server").show(),$("#server").attr("src",h+"/officeaddin"),$("#server").attr("height",1200),$("#server").height("1200px"),!1):($("#serverNameError").show(),!1);var e}),window.addEventListener("message",g,!1),(h=Cookies.get("serverName"))&&($("#serverNameDiv").hide(),$("#server").show(),$("#server").attr("src",h+"/officeaddin"),$("#server").attr("height",1200),$("#server").height("1200px")),$("#ifPara").click(l),$("#ifInline").click(p),$("#listPara").click(d),$("#insertTemplate").click(m),$("#commentPara").click(f),$("#insertVariable").click(s),$("#interviewName").on("change",function(e){var t,r=$("#interviewName").val();r?(console.log("YAML is now "+r),t=r,$("#server")[0].contentWindow.postMessage({action:"fetchVars",file:t},h)):console.log("YAML was blank")})})};for(var w=document.querySelectorAll(".ms-Dropdown"),y=0;y<w.length;++y)new fabric.Dropdown(w[y]);var R=document.querySelectorAll(".ms-CheckBox");for(y=0;y<R.length;y++)new fabric.CheckBox(R[y]);var b=document.querySelectorAll(".ms-TextField");for(y=0;y<b.length;y++)new fabric.TextField(b[y]);var k=document.querySelectorAll(".ms-ChoiceFieldGroup");for(y=0;y<k.length;y++)new fabric.ChoiceFieldGroup(k[y]);var B=document.querySelectorAll(".ms-CommandButton");for(y=0;y<B.length;y++)new fabric.CommandButton(B[y])}});