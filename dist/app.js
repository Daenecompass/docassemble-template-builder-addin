!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=125)}({125:function(e,t){var n="";function r(e){if(e.origin===n){if(console.log("Received action "+e.data.action),"initialize"==e.data.action&&($("#server").hide(),$("#app-body").show(),a()),"files"==e.data.action){var t=$("#interviewName").val();$("#interviewName").empty();var r=$("<option>");r.text("Select an interview..."),$("#interviewName").append(r);for(var o=e.data.files.length,i=0;i<o;i++){var c=$("<option>");c.attr("value",e.data.files[i]),c.text(e.data.files[i]),e.data.files[i]==t&&c.prop("selected",!0),$("#interviewName").append(c)}}"vars"==e.data.action&&(e.data.vars,e.data.vocab,a())}else console.log("Message received from improper origin.")}function a(){$("#server")[0].contentWindow.postMessage({action:"fetchFiles"},n)}Office.initialize=function(e){$(document).ready(function(){$("#sideload-msg").hide();try{var e=document.getElementById("server").contentWindow.document;e.open(),e.write("<html><head><title></title></head><body>Loading...</body></html>"),e.close()}catch(e){console.log(e.message)}$("#app-body").hide(),$("#serverSet").on("click",function(){return e=$("#serverName").val(),/^https?:\/\/\S/i.test(e)?($("#serverNameError").hide(),$("#serverNameDiv").hide(),n=$("#serverName").val(),Cookies.set("serverName",n,{expires:999999}),$("#server").show(),$("#server").attr("src",n+"/officeaddin"),$("#server").attr("height",1200),$("#server").height("1200px"),!1):($("#serverNameError").show(),!1);var e}),window.addEventListener("message",r,!1),(n=Cookies.get("serverName"))&&($("#serverNameDiv").hide(),$("#server").show(),$("#server").attr("src",n+"/officeaddin"),$("#server").attr("height",1200),$("#server").height("1200px")),$("#ifPara").click(m),$("#ifInline").click(v),$("#listPara").click(f),$("#insertTemplate").click(g),$("#commentPara").click(p),$("#insertVariable").click(u),$("#interviewName").on("change",function(e){var t,r=$("#interviewName").val();r?(console.log("YAML is now "+r),t=r,$("#server")[0].contentWindow.postMessage({action:"fetchVars",file:t},n)):console.log("YAML was blank")})})};for(var o=document.querySelectorAll(".ms-Dropdown"),i=0;i<o.length;++i)new fabric.Dropdown(o[i]);var c=document.querySelectorAll(".ms-CheckBox");for(i=0;i<c.length;i++)new fabric.CheckBox(c[i]);var s=document.querySelectorAll(".ms-TextField");for(i=0;i<s.length;i++)new fabric.TextField(s[i]);var l=document.querySelectorAll(".ms-ChoiceFieldGroup");for(i=0;i<l.length;i++)new fabric.ChoiceFieldGroup(l[i]);var d=document.querySelectorAll(".ms-CommandButton");for(i=0;i<d.length;i++)new fabric.CommandButton(d[i]);async function u(){return Word.run(async e=>{const t=e.document.getSelection();var n=document.getElementById("inputVariableName").value,r=document.getElementById("checkboxVariableReplaceAll").checked,a=document.getElementById("selectVariableFormat").value;if(""==a)var o=n;else o=a+"("+n+")";if(t.load("text"),r){await e.sync();var i=t.text,c=e.document.body.search(i.trim(),{matchWholeWord:!0});e.load(c),await e.sync();for(var s=0;s<c.items.length;s++)c.items[s].insertText("{{ "+o+" }}","Replace")}else t.insertText("{{ "+n+" }}","Replace");await e.sync()})}async function m(){return Word.run(async e=>{const t=e.document.getSelection();var n=document.getElementById("inputIfExpression").value;t.load("text");var r="{%p if "+n+" %}";t.insertParagraph(r,"Before"),t.insertParagraph("{%p endif %}","After"),await e.sync(),console.log(`The selected text was ${t.text}.`)})}async function v(){return Word.run(async e=>{const t=e.document.getSelection();var n="{% if "+document.getElementById("inputIfExpression").value+" %}";t.load("text"),t.insertText(n,"Before"),t.insertText("{% endif %}","After"),await e.sync(),console.log(`The selected text was ${t.text}.`)})}async function f(){return Word.run(async e=>{const t=e.document.getSelection();var n=document.getElementById("inputListVariableName").value;if(document.getElementById("checkboxOnlyTrue").checked)var r="{%p for item in "+n+".true_values() %}";else r="{%p for item in "+n+"%}";t.load("text"),t.insertText("{{ item }}","Replace"),t.insertParagraph(r,"Before"),t.insertParagraph("{%p endfor %}","After"),await e.sync(),console.log(`The selected text was ${t.text}.`)})}async function p(){return Word.run(async e=>{const t=e.document.getSelection();t.load("text"),await e.sync();var n=new RegExp("({#)([\\s\\S]*)(#})").exec(t.text);n?(t.insertText(n[2],"Replace"),console.log("Removed comments.")):(t.insertParagraph("{#","Before"),t.insertParagraph("#}","After"),console.log("Added comments.")),await e.sync()})}async function g(){return Word.run(async e=>{const t=e.document.getSelection();var n=document.getElementById("inputTemplateName").value,r=document.getElementById("inputTemplateOptions").value;if(""==r)var a='{{p include_docx_template("'+n+'") }}';else a='{{p include_docx_template("'+n+'", '+r+") }}";t.load("text"),t.insertText(a,"Replace"),await e.sync(),console.log(`The selected text was ${t.text}.`)})}}});